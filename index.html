<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>R-Rain: Catch the RC</title>
    <style>
        :root { --sky: #87ceeb; --grass: #2ecc71; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial Rounded MT Bold', sans-serif; }
        body { background: var(--sky); overflow: hidden; touch-action: none; }
        
        #ui { position: absolute; top: 20px; width: 100%; display: flex; justify-content: space-around; color: white; font-size: 24px; text-shadow: 2px 2px #000; z-index: 100; }
        
        .catcher { position: absolute; bottom: 50px; width: 80px; height: 80px; font-size: 60px; display: flex; align-items: center; justify-content: center; z-index: 50; transition: transform 0.1s; }
        
        .item { position: absolute; font-size: 40px; cursor: pointer; }
        
        .floor { position: absolute; bottom: 0; width: 100%; height: 60px; background: var(--grass); border-top: 5px solid #1e8449; }

        #game-over { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; color: white; }
        .btn { background: #f1c40f; border: none; padding: 15px 40px; border-radius: 30px; font-size: 20px; font-weight: bold; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div id="ui">
    <div>üí∞ RC: <span id="score">0</span></div>
    <div>‚ù§Ô∏è HP: <span id="hp">3</span></div>
</div>

<div id="game-over">
    <h1>YOMG'IR TUGADI!</h1>
    <p>Siz yig'gan RC: <span id="final-score">0</span></p>
    <button class="btn" onclick="location.reload()">QAYTA BOSHLASH</button>
</div>

<div class="catcher" id="player">üß∫</div>
<div class="floor"></div>

<script>
    const player = document.getElementById('player');
    const scoreEl = document.getElementById('score');
    const hpEl = document.getElementById('hp');
    const gameOverScreen = document.getElementById('game-over');

    let score = 0;
    let hp = 3;
    let gameActive = true;
    let items = [];

    // Savatchani boshqarish
    window.addEventListener('mousemove', (e) => { moveCatcher(e.clientX); });
    window.addEventListener('touchmove', (e) => { moveCatcher(e.touches[0].clientX); });

    function moveCatcher(x) {
        if(!gameActive) return;
        let pos = x - 40;
        if(pos < 0) pos = 0;
        if(pos > window.innerWidth - 80) pos = window.innerWidth - 80;
        player.style.left = pos + 'px';
    }

    function createItem() {
        if(!gameActive) return;
        const item = document.createElement('div');
        item.className = 'item';
        
        const isBomb = Math.random() > 0.8;
        item.innerText = isBomb ? 'üí£' : 'üí∞';
        item.dataset.type = isBomb ? 'bomb' : 'coin';
        
        item.style.left = Math.random() * (window.innerWidth - 40) + 'px';
        item.style.top = '-50px';
        document.body.appendChild(item);
        items.push(item);

        setTimeout(createItem, 600);
    }

    function update() {
        if(!gameActive) return;

        items.forEach((item, index) => {
            let top = parseFloat(item.style.top);
            item.style.top = (top + 5) + 'px';

            // To'qnashuvni tekshirish
            if (checkCollision(player, item)) {
                if(item.dataset.type === 'coin') {
                    score += 10;
                    scoreEl.innerText = score;
                } else {
                    hp--;
                    hpEl.innerText = hp;
                    if(hp <= 0) gameOver();
                }
                item.remove();
                items.splice(index, 1);
            }

            // Yerga tegsa
            if (top > window.innerHeight - 100) {
                item.remove();
                items.splice(index, 1);
            }
        });

        requestAnimationFrame(update);
    }

    function checkCollision(p, i) {
        const pRect = p.getBoundingClientRect();
        const iRect = i.getBoundingClientRect();
        return !(pRect.top > iRect.bottom || pRect.bottom < iRect.top || pRect.right < iRect.left || pRect.left > iRect.right);
    }

    function gameOver() {
        gameActive = false;
        gameOverScreen.style.display = 'flex';
        document.getElementById('final-score').innerText = score;
    }

    createItem();
    update();
</script>
</body>
</html>